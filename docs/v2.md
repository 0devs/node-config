# @0devs/config 2.x

simplify config API and plugin creation


## `.from()`

from plugin just a function that return Promise

```ts
// no .use methods
// plugin just a function in .from method

const config = new Config();

// read config from json without plugin
import {readFile} from "fs";

// just a function
const readFromJson = () => {
  return new Promise((resolve, reject) => {

    fs.readFile("/etc/cfg.json", (err, data) => {
      if (err) {
        return reject(err);
      }
      resolve(JSON.parse(data));
    });

  })
};

config.from(readFromJson, ".");
```

from-plugin - just more useful function

```ts
// read config from json plugin
import json from "@0devs/config-from-json";

config.from(json("/etc/cfg.json"), ".");
```

than your can create any "from"-plugins, that read data from any source

```ts
import createConsulPlugin from "@0devs/config-from-consul";

const consul = createConsulPlugin({host: "", port: ""});

config
  .from(consul("services/test"), ".")
  .from(consul("services/db"), "db")


  // and from anywhere
  .from(vault("secrets/db/username"), "db.username")
  .from(vault("secrets/db/password"), "db.password")
  .from(env("PORT"), "server.port")
```

from-plugins execute in order and value in `env("PORT")` replace value that read before

## `.defaults()`

defaults set defaults values and every read of all config `.from(..., ".")` merge with defaults

defaults can be used with from-plugins

```ts
config.defaults({
  host: null,
  port: 80,
});

config.defaults(json("/etc/cfg.json"));
```

## read errors

some of source can't exists

for example, read config from json file, and file can not be found, than you want use defaults without any errors - use `.fromOptional`

all errors in this from catched and logged with logger if you pass it, or console.log if not

```ts
import Config from "@0devs/config";

const config = new Config(logger);

config
  .defaults({host: null, port: 80})
  .fromOptional(json("/etc/cfg.json"), ".");
```

same for defaults


# @0devs/config 2.x API

## `.from(source: () => Promise<any>, destination: string | string[]): this`
## `.fromOptional(source: () => Promise<any>, destination: string | string[]): this`
## `.defaults(object | (() => Promise<any>))`
## `.defaultsOptional(object | (() => Promise<any>))`
## `.get(...)`
## `.set(...)`
## `.read(): Promise<void>`
## `.validation(fn: () => Promise<void>)`
## `.validate(): Promise<void>`
